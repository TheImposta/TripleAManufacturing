<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Reset Password | Triple A</title>
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="navbar">
    <div class="nav-inner">
      <a href="index.html" class="logo" style="display: flex; align-items: center; text-decoration: none; color: #000; font-weight: 700;">
        <img src="assets/logo.png" alt="Triple A" style="height: 32px; margin-right: 12px;">
        TRIPLE A
      </a>
    </div>
  </header>

  <section class="container" style="max-width: 440px; margin-top: 80px;">
    <div class="product-card" style="padding: 40px; text-align: center;">
      <h1 style="font-size: 32px; margin-bottom: 8px;">New Password.</h1>
      <p style="margin-bottom: 32px; color: #86868b;">Enter a new secure password for your account.</p>
      
      <div style="display: flex; flex-direction: column; gap: 16px;">
        <input id="new-password" type="password" placeholder="Minimum 6 characters" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #d2d2d7;">
        <button id="updateBtn" style="width: 100%; padding: 12px; background: #0071e3; color: #fff; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Update Password</button>
      </div>
      <p id="msg" style="margin-top: 20px; font-size: 14px; color: #ff3b30;"></p>
    </div>
  </section>

  <script type="module">
    import { supabase } from './js/supabase.js';

    const updateBtn = document.getElementById('updateBtn');
    const msg = document.getElementById('msg');

    updateBtn.onclick = async () => {
      const newPassword = document.getElementById('new-password').value;

      if (newPassword.length < 6) {
        msg.style.color = "#ff3b30";
        msg.innerText = "Password must be at least 6 characters.";
        return;
      }

      updateBtn.innerText = "Updating...";
      updateBtn.disabled = true;

      const { error } = await supabase.auth.updateUser({ password: newPassword });

      if (error) {
        msg.style.color = "#ff3b30";
        msg.innerText = error.message;
        updateBtn.innerText = "Update Password";
        updateBtn.disabled = false;
      } else {
        alert("Success! Your password has been updated.");
        window.location.href = "auth.html";
      }
    };
  </script>
</body>
</html>
